╔══════════════════════════════════════════════════════════════════════════════════╗
║                        TalkAR SYSTEM ARCHITECTURE OVERVIEW                        ║
╚══════════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              CLIENT TIER                                         │
└─────────────────────────────────────────────────────────────────────────────────┘

    ┌─────────────────────────┐              ┌─────────────────────────┐
    │   📱 MOBILE APP          │              │  💻 ADMIN DASHBOARD     │
    │   ─────────────          │              │  ────────────────       │
    │   • Android/Kotlin       │              │  • React 18.2.0         │
    │   • ARCore 1.41.0        │              │  • TypeScript           │
    │   • Jetpack Compose      │              │  • Material-UI 5.15.0   │
    │   • Material Design 3    │              │  • Redux Toolkit 2.0.1  │
    │   • Room Database        │              │  • React Router 6.20.1  │
    │   • Retrofit 2.9.0       │              │  • Axios 1.6.2          │
    │   • ML Kit               │              │                         │
    └───────────┬─────────────┘              └───────────┬─────────────┘
                │                                        │
                │ REST API (HTTPS)                       │ REST API (HTTPS)
                │                                        │
                └───────────────┬────────────────────────┘
                                │
                                ▼

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              API GATEWAY TIER                                    │
└─────────────────────────────────────────────────────────────────────────────────┘

                    ┌─────────────────────────────────┐
                    │   🌐 BACKEND API SERVER         │
                    │   ──────────────────────        │
                    │   • Node.js 18+                 │
                    │   • TypeScript 5.3.3            │
                    │   • Express.js 4.18.2           │
                    │   • JWT Authentication          │
                    │   • Helmet.js Security          │
                    │   • CORS Protection             │
                    │   • Morgan Logging              │
                    └──────────────┬──────────────────┘
                                   │
                    ┌──────────────┴──────────────┐
                    │                             │
                    ▼                             ▼

        ┌─────────────────────┐         ┌─────────────────────┐
        │   API ROUTES        │         │   MIDDLEWARE        │
        │   ──────────        │         │   ──────────        │
        │   /auth             │         │   • Authentication  │
        │   /images           │         │   • Validation      │
        │   /avatars          │         │   • Error Handler   │
        │   /sync             │         │   • Not Found       │
        │   /lipsync          │         └─────────────────────┘
        │   /enhanced-lipsync │
        │   /scripts          │
        │   /analytics        │
        └──────────┬──────────┘
                   │
                   ▼

        ┌──────────────────────────────────────┐
        │   BUSINESS SERVICES                  │
        │   ─────────────────                  │
        │   • authService.ts                   │
        │   • syncService.ts                   │
        │   • enhancedLipSyncService.ts        │
        │   • mockLipSyncService.ts            │
        │   • uploadService.ts                 │
        │   • analyticsService.ts              │
        └──────────────────┬───────────────────┘
                           │
                           ▼

        ┌──────────────────────────────────────┐
        │   DATA MODELS (Sequelize ORM)        │
        │   ─────────────────────────────      │
        │   • User                             │
        │   • Image                            │
        │   • Avatar                           │
        │   • Dialogue                         │
        │   • ImageAvatarMapping               │
        │   • associations.ts                  │
        └──────────────────┬───────────────────┘
                           │
                           ▼

┌─────────────────────────────────────────────────────────────────────────────────┐
│                              DATA TIER                                           │
└─────────────────────────────────────────────────────────────────────────────────┘

    ┌──────────────────────┐              ┌──────────────────────┐
    │  🗄️  PostgreSQL 15   │              │  ☁️  AWS S3 Storage   │
    │  ──────────────────  │              │  ─────────────────   │
    │  • talkar_db         │              │  • Images            │
    │  • Port 5432         │              │  • Thumbnails        │
    │  • Users             │              │  • Avatar Images     │
    │  • Images            │              │  • Generated Videos  │
    │  • Avatars           │              │  • Static Assets     │
    │  • Dialogues         │              │  • Cached Content    │
    │  • Mappings          │              └──────────────────────┘
    └──────────────────────┘

┌─────────────────────────────────────────────────────────────────────────────────┐
│                          EXTERNAL SERVICES TIER                                  │
└─────────────────────────────────────────────────────────────────────────────────┘

    ┌──────────────────────┐   ┌──────────────────────┐   ┌──────────────────────┐
    │  🎬 Sync API         │   │  📷 ARCore (Google)  │   │  🤖 ML Kit (Google)  │
    │  ────────────        │   │  ─────────────────   │   │  ─────────────────   │
    │  • Video Generation  │   │  • Image Recognition │   │  • Image Labeling    │
    │  • Lip-sync          │   │  • Image Tracking    │   │  • Object Detection  │
    │  • Voice Synthesis   │   │  • AR Anchors        │   │  • Vision API        │
    │  • Multi-language    │   │  • AR Sessions       │   └──────────────────────┘
    └──────────────────────┘   └──────────────────────┘

═════════════════════════════════════════════════════════════════════════════════════

                              DATA FLOW DIAGRAM

  ┌─────────┐     ┌──────────────┐     ┌─────────┐     ┌──────────┐     ┌─────────┐
  │  Admin  │────>│   Upload     │────>│ Backend │────>│   S3     │────>│   DB    │
  │  User   │     │   Image +    │     │   API   │     │ Storage  │     │ (Save)  │
  └─────────┘     │   Script     │     └─────────┘     └──────────┘     └─────────┘
                  └──────────────┘

  ┌─────────┐     ┌──────────────┐     ┌─────────┐     ┌──────────┐     ┌─────────┐
  │  Mobile │────>│   ARCore     │────>│ Backend │────>│ Sync API │────>│  Video  │
  │  User   │     │   Recognize  │     │   API   │     │ Generate │     │   URL   │
  └─────────┘     │   Image      │     └─────────┘     └──────────┘     └─────────┘
                  └──────────────┘                                            │
                                                                              │
  ┌─────────┐     ┌──────────────┐     ┌─────────┐     ┌──────────────────┐ │
  │  Mobile │<────│  Display AR  │<────│  Video  │<────│  Download Video  │<┘
  │  Screen │     │   Overlay    │     │  Ready  │     └──────────────────┘
  └─────────┘     └──────────────┘     └─────────┘

═════════════════════════════════════════════════════════════════════════════════════

                        MOBILE APP ARCHITECTURE (MVVM)

  ┌─────────────────────────────────────────────────────────────────────────────┐
  │                           UI LAYER (Jetpack Compose)                         │
  │  ─────────────────────────────────────────────────────────────────────────  │
  │  • ARScreen.kt                    • Week2ARScreen.kt                         │
  │  • EnhancedARScreen.kt            • Components (ARView, CameraView, etc.)   │
  └────────────────────────────────────────┬────────────────────────────────────┘
                                           │
                                           ▼
  ┌─────────────────────────────────────────────────────────────────────────────┐
  │                         VIEWMODEL LAYER (Business Logic)                     │
  │  ─────────────────────────────────────────────────────────────────────────  │
  │  • ARViewModel.kt                 • SimpleARViewModel.kt                     │
  │  • EnhancedARViewModel.kt         • State Management                        │
  └────────────────────────────────────────┬────────────────────────────────────┘
                                           │
                                           ▼
  ┌─────────────────────────────────────────────────────────────────────────────┐
  │                      REPOSITORY LAYER (Data Abstraction)                     │
  │  ─────────────────────────────────────────────────────────────────────────  │
  │  • ImageRepository.kt             • SyncRepository.kt                        │
  └─────────────────┬──────────────────────────────────────┬────────────────────┘
                    │                                      │
         ┌──────────▼──────────┐              ┌───────────▼────────────┐
         │   AR SERVICES       │              │   DATA SOURCES         │
         │   ────────────      │              │   ────────────         │
         │   • ARCore Service  │              │   • API Client         │
         │   • ML Kit Service  │              │   • ImageDao (Room)    │
         │   • Enhanced AR     │              │   • Local DB           │
         └─────────────────────┘              └────────────────────────┘

═════════════════════════════════════════════════════════════════════════════════════

                            DATABASE SCHEMA (PostgreSQL)

  ┌──────────────┐         ┌──────────────┐         ┌──────────────────────┐
  │    USERS     │         │    IMAGES    │         │      DIALOGUES       │
  │──────────────│         │──────────────│         │──────────────────────│
  │ id (PK)      │         │ id (PK)      │◄────────│ id (PK)              │
  │ email (UK)   │─────┐   │ name         │         │ imageId (FK)         │
  │ password     │     │   │ description  │         │ text                 │
  │ role         │     │   │ imageUrl     │         │ language             │
  │ createdAt    │     │   │ thumbnailUrl │         │ voiceId              │
  │ updatedAt    │     │   │ isActive     │         │ isDefault            │
  └──────────────┘     │   │ userId (FK)  │         │ createdAt            │
                       └──>│ createdAt    │         │ updatedAt            │
                           │ updatedAt    │         └──────────────────────┘
                           └──────────────┘
                                  ▲
                                  │
                           ┌──────┴───────┐
                           │              │
                  ┌────────▼────────┐   ┌─▼──────────────────┐
                  │    AVATARS      │   │ IMAGE_AVATAR_MAP   │
                  │─────────────────│   │────────────────────│
                  │ id (PK)         │◄──│ id (PK)            │
                  │ name            │   │ imageId (FK)       │
                  │ voiceId (UK)    │   │ avatarId (FK)      │
                  │ language        │   │ scriptId           │
                  │ gender          │   │ createdAt          │
                  │ avatarImageUrl  │   │ updatedAt          │
                  │ description     │   └────────────────────┘
                  │ isActive        │
                  │ createdAt       │
                  │ updatedAt       │
                  └─────────────────┘

═════════════════════════════════════════════════════════════════════════════════════

                          DEPLOYMENT ARCHITECTURE (Kubernetes)

                              ┌──────────────┐
                              │  INTERNET    │
                              └──────┬───────┘
                                     │
                              ┌──────▼────────┐
                              │ Load Balancer │
                              │   (Ingress)   │
                              └──────┬────────┘
                                     │
                    ┌────────────────┴────────────────┐
                    │                                 │
            ┌───────▼────────┐              ┌────────▼─────────┐
            │  Backend Pods  │              │ Dashboard Pods   │
            │  ─────────────│              │ ──────────────   │
            │  • Pod 1      │              │  • Pod 1         │
            │  • Pod 2      │              │  • Pod 2         │
            │  • Pod 3      │              └──────────────────┘
            └───────┬────────┘
                    │
        ┌───────────┴───────────┐
        │                       │
  ┌─────▼──────┐         ┌──────▼───────┐
  │ PostgreSQL │         │   AWS S3     │
  │  StatefulSet│         │   Storage    │
  │            │         │              │
  │ • Primary  │         │ • Images     │
  │ • Replica  │         │ • Videos     │
  └────────────┘         └──────────────┘

═════════════════════════════════════════════════════════════════════════════════════

                              TECHNOLOGY STACK SUMMARY

  ┌──────────────────────┬────────────────────┬─────────────────────────────────┐
  │     COMPONENT        │    TECHNOLOGY      │          VERSION                │
  ├──────────────────────┼────────────────────┼─────────────────────────────────┤
  │  Mobile Platform     │  Android           │  Min SDK 24, Target SDK 34      │
  │  Mobile Language     │  Kotlin            │  Latest                         │
  │  Mobile UI           │  Jetpack Compose   │  2023.10.01 BOM                 │
  │  AR Framework        │  ARCore            │  1.41.0                         │
  │  ML Framework        │  ML Kit            │  17.0.7                         │
  │  Mobile Network      │  Retrofit          │  2.9.0                          │
  │  Mobile Database     │  Room              │  2.6.1                          │
  │  Image Loading       │  Coil              │  2.5.0                          │
  ├──────────────────────┼────────────────────┼─────────────────────────────────┤
  │  Backend Runtime     │  Node.js           │  18+                            │
  │  Backend Language    │  TypeScript        │  5.3.3                          │
  │  Backend Framework   │  Express.js        │  4.18.2                         │
  │  Database            │  PostgreSQL        │  15                             │
  │  ORM                 │  Sequelize         │  6.35.1                         │
  │  Authentication      │  JWT               │  jsonwebtoken 9.0.2             │
  │  Cloud Storage       │  AWS S3            │  SDK 2.1490.0                   │
  │  Validation          │  Joi               │  17.11.0                        │
  │  Security            │  Helmet            │  7.1.0                          │
  ├──────────────────────┼────────────────────┼─────────────────────────────────┤
  │  Dashboard Framework │  React             │  18.2.0                         │
  │  Dashboard Language  │  TypeScript        │  4.9.5                          │
  │  UI Library          │  Material-UI       │  5.15.0                         │
  │  State Management    │  Redux Toolkit     │  2.0.1                          │
  │  Routing             │  React Router      │  6.20.1                         │
  │  HTTP Client         │  Axios             │  1.6.2                          │
  │  Forms               │  React Hook Form   │  7.48.2                         │
  ├──────────────────────┼────────────────────┼─────────────────────────────────┤
  │  Container Platform  │  Docker            │  Latest                         │
  │  Orchestration       │  Kubernetes        │  Latest                         │
  │  Monitoring          │  Prometheus        │  Latest                         │
  └──────────────────────┴────────────────────┴─────────────────────────────────┘

═════════════════════════════════════════════════════════════════════════════════════

                              KEY FEATURES BY MODULE

  📱 MOBILE APP
  ─────────────
  ✓ Real-time AR image recognition (ARCore + ML Kit)
  ✓ Image tracking with AR anchors
  ✓ Lip-sync video overlay on tracked images
  ✓ Offline support with Room database
  ✓ Multi-language content support
  ✓ Modern Material Design 3 UI
  ✓ Camera permission handling
  ✓ Network error recovery

  🌐 BACKEND API
  ──────────────
  ✓ RESTful API with JWT authentication
  ✓ Image upload and management
  ✓ Avatar and dialogue management
  ✓ Sync API integration for video generation
  ✓ Enhanced lip-sync service
  ✓ Mock lip-sync for development/testing
  ✓ Analytics and usage tracking
  ✓ AWS S3 cloud storage integration
  ✓ PostgreSQL database with Sequelize ORM
  ✓ Comprehensive error handling
  ✓ Input validation and security

  💻 ADMIN DASHBOARD
  ──────────────────
  ✓ Content management (images, scripts, avatars)
  ✓ Image upload with drag-and-drop
  ✓ Multi-language dialogue editor
  ✓ Analytics dashboard
  ✓ User management
  ✓ Redux state management
  ✓ Responsive Material-UI design

═════════════════════════════════════════════════════════════════════════════════════

                              SECURITY LAYERS

  Layer 1: NETWORK SECURITY
  ─────────────────────────
  • HTTPS/TLS encryption
  • CORS protection
  • Rate limiting
  • DDoS protection (Load Balancer)

  Layer 2: APPLICATION SECURITY
  ─────────────────────────────
  • JWT authentication
  • Password hashing (bcryptjs)
  • Helmet.js security headers
  • Input validation (Joi)
  • SQL injection prevention (Sequelize ORM)
  • XSS protection

  Layer 3: DATA SECURITY
  ──────────────────────
  • Database encryption at rest
  • Secure environment variables
  • API key rotation
  • S3 bucket access controls
  • Least privilege IAM roles

═════════════════════════════════════════════════════════════════════════════════════

                            INTEGRATION POINTS

  MOBILE APP ←→ BACKEND API
  ─────────────────────────
  • REST API over HTTPS
  • JWT token authentication
  • JSON data format
  • Multipart form data for images

  BACKEND API ←→ SYNC API
  ───────────────────────
  • HTTP/HTTPS requests
  • API key authentication
  • Async video generation
  • Status polling mechanism

  BACKEND API ←→ AWS S3
  ─────────────────────
  • AWS SDK integration
  • IAM role authentication
  • Multipart upload for large files
  • CloudFront CDN (optional)

  MOBILE APP ←→ ARCORE
  ────────────────────
  • Native Android SDK
  • Image database management
  • Session lifecycle handling
  • AR anchor management

═════════════════════════════════════════════════════════════════════════════════════
